<!DOCTYPE html>
<html>
  <head>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/css/bootstrap.min.css" integrity="sha384-PsH8R72JQ3SOdhVi3uxftmaW6Vc51MKb0q5P2rRUpPvrszuE4W1povHYgTpBfshb" crossorigin="anonymous">
    <script
    src="https://code.jquery.com/jquery-3.2.1.min.js"
    integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
    crossorigin="anonymous"></script>
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCl9gYSaGMtTUjkGDPBhHC4jZnhGmTskog"></script>
    <script>
      function getCampsites(url, centre) {
        $.ajax({
          type: 'GET',
          url: url
        })
        .done(function(data) {
          initMap(data, centre)
        })
      }
      getCampsites('/find/France')

      function saveNewCampsite(data) {
        $.ajax({
          type: 'POST',
          url: '/campsite',
          data: data
        })
        .done(function(data) {
          alert('Saved ' + data.name)
        })
      }

    </script>

    <script>
    var map
      function initMap(json, center) {
        centre = {
          latitude: 48.1117058,
          longitude: 7.3223645
        }

        map = new google.maps.Map(document.getElementById('map'), {
          zoom: 7,
          center: {lat: centre.latitude, lng: centre.longitude}
        });

        var infowindow = new google.maps.InfoWindow({
          content: content
        });

        for (var i = 0; i < json.length; i++) {
          var content = '<div id="content">'+
              '<div id="siteNotice">'+
              '</div>'+
              '<h1 id="firstHeading" class="firstHeading">' + json[i].name + '</h1>'+
              '<div id="bodyContent">'+
              '<p><b>' + json[i].address + '</b>' +
              '</div>'+
              '</div>';

          var lat = parseInt(json[i].address.gps.latitude);
          var lng = parseInt(json[i].address.gps.longitude);

          var marker = new google.maps.Marker({
            position: {lat: lat, lng: lng},
            map: map,
            content: content
          });

          marker.addListener('click', function() {
                 infowindow.setContent(this.content);
                 infowindow.open(map, this);
           });

          var infowindow = new google.maps.InfoWindow({});
        }
      }

    </script>
    <style>
       #map {
        height: 400px;
        width: 100%;
       }
       .map-control {
         display: none;
       }
    </style>
  </head>
  <body>
    <h1>Guyrope</h1>
    <div class="container">
      <div class="row">
        <div class="col">
          <div id="map"></div>
          <button value="button" onclick="getCampsites('/location/-73.97822040000001/40.6435254/5')">btn</button>
        </div>
        <div class="col">
          <div id="form">Add campsite</div>
          <form>
            <label>Name: <input type="text" name="name"></label>
            <input type="submit" id="submitButton">
          </form>
        </div>
      </div>
    </div>
  </body>
</html>
